# 注释最佳实践

## 1. 功能优先原则

### ✅ 好的注释

```python
"""查询处理器，负责解析用户查询并执行检索。

主要功能：
- parse_query(): 解析查询字符串
- execute(): 执行检索并返回结果
"""
```

### ❌ 不好的注释

```python
"""查询处理模块。

架构说明：
- 服务层：QueryService 类
- 数据层：QueryRepository 类
- 工具层：QueryHelper 类

设计模式：
- 使用了工厂模式创建查询对象
- 使用了策略模式选择检索策略
- ...（过多架构细节）
"""
```

## 2. 快速理解原则

### ✅ 让人立即明白

```python
"""Git 仓库管理器，支持克隆和增量更新。

快速开始：
    manager = GitRepositoryManager(repo_url)
    manager.clone()  # 首次克隆
    manager.pull()   # 增量更新
"""
```

### ❌ 需要仔细阅读才能理解

```python
"""这个模块实现了一个基于 Git 协议的仓库管理功能，
它封装了 gitpython 库的底层操作，提供了更高级的抽象接口，
支持多种操作模式和配置选项..."""
```

## 3. 避免的内容

### 3.1 避免详细架构分层

```python
# ❌ 不要这样
"""
架构分层：
- 表现层（Presentation Layer）
  - 负责用户交互和UI展示
  - 包含：views.py, forms.py, templates/
- 业务层（Business Layer）
  - 负责核心业务逻辑
  - 包含：services.py, validators.py
- 数据层（Data Layer）
  ...
"""
```

### 3.2 避免重复代码信息

```python
# ❌ 不要这样
"""
方法列表：
- __init__(self, config): 初始化实例
- process(self, query): 处理查询
- validate(self, data): 验证数据
- format(self, result): 格式化结果
"""
# 这些信息代码本身已经说明了
```

### 3.3 避免过长的执行流程

```python
# ❌ 不要这样（除非是脚本文件）
"""
执行流程：
1. 首先，加载配置文件
2. 然后，初始化数据库连接
3. 接着，创建服务实例
4. 之后，注册回调函数
5. 最后，启动主循环
6. 在主循环中，...
"""
```

## 4. 检查清单

### 新建文件时

- [ ] 第一句话是否清晰描述文件功能？
- [ ] 主要功能是否列出？
- [ ] 是否提供快速开始示例？（推荐）
- [ ] 篇幅是否控制在 20-30 行内？

### 修改文件时

- [ ] 注释是否与代码保持一致？
- [ ] 是否存在过时的信息？
- [ ] 是否存在过多架构细节？
- [ ] 是否需要精简？

## 5. 注释更新时机

| 情况 | 是否更新注释 |
|------|-------------|
| 添加新功能 | ✅ 更新主要功能列表 |
| 修改接口 | ✅ 更新使用示例 |
| 内部重构 | ⚠️ 检查是否需要更新 |
| 修复 Bug | ❌ 通常不需要 |
