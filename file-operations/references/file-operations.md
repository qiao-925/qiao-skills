---
description: 文件操作规范，包括文件变更授权、创建策略等
alwaysApply: true
globs: []
---

# 文件操作规范

## 🚨 核心指令（必须严格执行）

**在执行任何文件系统操作前，必须遵循以下流程，不得跳过：**

## 📋 文件变更授权机制
1. **明确授权**：创建、修改、删除文件或文件夹前，必须先获得用户明确授权
2. **变更预览**：提供修改前后的对比样例，让用户清晰了解变更内容
3. **操作确认**：等待用户确认后再执行实际操作

**示例流程**：
```
AI: "我建议修改XXX文件，将A改为B。修改前：[代码片段]，修改后：[代码片段]。是否执行？"
用户: "确认" / "取消"
AI: [执行操作]
```

## 📋 文件创建策略

- **核心原则**：必须在用户许可或主动要求时才能创建文档
- **默认行为**：优先在对话中呈现内容，而非直接创建文件
- **主动建议**：当内容有价值且可能需要持久化时，主动询问用户是否需要保存
- **建议话术**：使用友好的询问方式，例如："需要为你生成一份持久化的文档记录吗？"
- **避免行为**：不要未经用户明确需求就创建各种临时文件或文档

**判断标准**：
- ✅ 用户明确要求创建文件 → 直接创建
- ✅ 用户明确许可创建 → 可以创建
- ✅ 内容具有长期价值 → 建议创建，等待确认
- ❌ 临时性内容 → 仅在对话中呈现
- ❌ 用户未提及文件需求 → 不主动创建
- ❌ 未获得用户许可 → 禁止创建

## 📁 文件夹重命名规范

### Emoji字符处理

**问题背景**：
Windows系统的PowerShell和cmd在处理包含emoji字符的文件夹名时存在编码问题，emoji字符在重命名过程中可能丢失。

**解决方案**：
- ✅ **优先使用Python脚本**：重命名包含emoji的文件夹时，必须使用Python脚本而非PowerShell的`Rename-Item`或cmd的`ren`命令
- ✅ **原因**：Python对Unicode/emoji支持更好，能正确处理UTF-8编码的文件夹名

**标准流程**：
1. 创建临时Python脚本（放在`scripts/`目录）
2. 使用Python的`os.rename()`函数执行重命名
3. 验证重命名结果（检查第一个字符是否为预期的emoji）
4. 清理临时脚本文件

**示例代码模板**：
```python
# -*- coding: utf-8 -*-
import os

os.chdir(r'目标目录路径')
old_name = '旧文件夹名'
new_name = '新文件夹名（包含emoji）'
if os.path.exists(old_name) and old_name != new_name:
    os.rename(old_name, new_name)
    print(f'成功重命名: {old_name} -> {new_name}')
```

**注意事项**：
- 临时脚本执行完成后应立即删除
- 重命名后验证文件夹名是否正确包含emoji字符
- 如果Python脚本路径不在当前目录，注意使用相对路径（如`../scripts/`）
